window.onload=function(){toggleMobileMenu();initForm();collapseNavbar();tabWithButtons();window.onresize=checkWidth;document.querySelectorAll('.page-scroll').forEach(function(el){el.addEventListener('click',function(e){e.preventDefault();scrollToSection(this)})});// Store gclid
var gclid=getParamValue(document.referrer,'gclid');if(gclid){localStorage.setItem('gclid',gclid)}// Collapse navbar on scroll
function collapseNavbar(){var navbarFixedTopEl=document.getElementsByClassName('navbar-fixed-top');navbarFixedTopEl[0].classList[window.scrollY<50?'add':'remove']('top-nav-collapse')}window.onscroll=collapseNavbar};function scrollToSection(target_el){var target_href=target_el.getAttribute('href').substr(1);var to=document.getElementById(target_href).offsetTop-70;scrollTo(to,500);collapseMenu()}function initForm(){var signup_forms=document.querySelectorAll('.signup-form');var ws=wsConnect();function sendVerifyEmail(val){var trimmed_email=trimEmail(val);wsSend(ws,{verify_email:trimmed_email,type:'account_opening'})}function verifySubmit(msg){var response=JSON.parse(msg.data);setValidationStyle(el_email,response.error);if(!response.error){signup_forms.forEach(function(el){el.querySelector('.signup-form-input').classList.add('invisible');el.querySelector('.signup-form-success').classList.remove('invisible')})}}function trimEmail(str){return str.replace(/\s/g,'')}var validation_set=false;// To prevent validating before submit
signup_forms.forEach(function(form){form.addEventListener('submit',handleSubmit)});var el_email=void 0;function handleSubmit(e){e.preventDefault();var el_form=this;el_email=el_form.querySelector('input[type="email"]');if(!validateEmail(el_email.value)){if(!validation_set){['input','change'].forEach(function(evt){el_email.addEventListener(evt,function(){setValidationStyle(!validateEmail(el_email.value))})});setValidationStyle(!validateEmail(el_email.value));validation_set=true}var to=this.offsetTop-50;scrollTo(to,500);// Scroll to nearest form
return false}if(ws.readyState===1){sendVerifyEmail(el_email.value)}else{ws=wsConnect();ws.onopen=sendVerifyEmail(el_email.value);ws.onmessage=verifySubmit}return true}ws.onmessage=verifySubmit}function validateEmail(email){return /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,63}$/.test(email)}function setValidationStyle(has_error){document.querySelectorAll('input[type="email"]').forEach(function(el){el.classList[has_error?'add':'remove']('error-field')});document.querySelectorAll('.error-msg').forEach(function(el){el.classList[has_error?'remove':'add']('invisible')})}function tabWithButtons(id){var el_tab_container=document.getElementById(id)?document.getElementById(id):document.body;var el_content_container=el_tab_container.getElementsByClassName('twb-content-container')[0];var el_content_wrapper=el_tab_container.getElementsByClassName('twb-content-wrapper')[0];var el_contents=el_tab_container.querySelectorAll('div.twb-content');var num_of_items=el_contents.length;var current_index=0;var navs=void 0;var touchstartX=0;var touchstartY=0;var touchendX=0;var touchendY=0;(function(){var parent=el_tab_container.querySelector('.twb-buttons');var ul=document.createElement('ul');for(var idx=0;idx<num_of_items;idx++){var li=createLIElement(idx);ul.appendChild(li)}var btn_prev=document.createElement('a');btn_prev.classList.add('twb-button','twb-button-prev');btn_prev.setAttribute('href','javascript:;');btn_prev.addEventListener('click',function(e){e.preventDefault();updateTabContent(--current_index)});var btn_next=document.createElement('a');btn_next.classList.add('twb-button','twb-button-next');btn_next.setAttribute('href','javascript:;');btn_next.addEventListener('click',function(e){e.preventDefault();updateTabContent(++current_index)});parent.appendChild(btn_prev);parent.appendChild(ul);parent.appendChild(btn_next);navs=ul.querySelectorAll('li');window.onresize=function(){updateTabContent(current_index)};el_content_wrapper.addEventListener('touchstart',function(event){touchstartX=event.changedTouches[0].screenX;touchstartY=event.changedTouches[0].screenY},false);el_content_wrapper.addEventListener('touchend',function(event){touchendX=event.changedTouches[0].screenX;touchendY=event.changedTouches[0].screenY;touchEventsHandler()},false);function touchEventsHandler(){var diffY=touchendY-touchstartY;var nochangeY=diffY>=-15&&diffY<=15;if(touchendX<=touchstartX&&nochangeY){updateTabContent(++current_index);// swipe left
}if(touchendX>=touchstartX&&nochangeY){updateTabContent(--current_index);// swipe right
}}function createLIElement(index){var li=document.createElement('li');li.classList[index?'remove':'add']('active');li.addEventListener('click',function(e){e.preventDefault();updateTabContent(index,false);current_index=index});return li}})();function updateTabContent(target_index){var direction=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var width=el_content_container.getBoundingClientRect().width;var mod=target_index%num_of_items;var active_index=void 0;if(direction){active_index=mod;if(mod<0){active_index=mod+num_of_items}}else{active_index=target_index}updateActiveContent(active_index);updateActiveNav(active_index);function updateActiveContent(idx){var offset=idx*width;el_content_container.style.left=(offset>0?-offset:offset)%(num_of_items*width)+'px'}function updateActiveNav(idx){navs.forEach(function(el,i){el.classList[idx===i?'add':'remove']('active')})}}}
//# sourceMappingURL=japan_2.js.map
