{"version":3,"sources":["../../../src/javascript/landing_pages/japan.js"],"names":["window","onload","toggleMobileMenu","initForm","onresize","checkWidth","gclid","getParamValue","document","referrer","localStorage","setItem","commonOnload","signup_forms","querySelectorAll","ws","wsConnect","sendVerifyEmail","val","wsSend","verify_email","type","validation_set","forEach","form","addEventListener","handleSubmit","el_email","e","preventDefault","el_form","querySelector","validateEmail","value","evt","setValidationStyle","readyState","onopen","onmessage","msg","response","JSON","parse","data","error","el","classList","add","remove","email","test","has_error"],"mappings":"AAAA,mCACAA,OAAOC,MAAP,CAAgB,UAAW,CACvBC,mBACAC,WAEAH,OAAOI,QAAP,CAAkBC,UAAlB,CAEA;AACA,GAAMC,OAAQC,cAAcC,SAASC,QAAvB,CAAiC,OAAjC,CAAd,CACA,GAAIH,KAAJ,CAAW,CACPI,aAAaC,OAAb,CAAqB,OAArB,CAA8BL,KAA9B,CACH,CAEDM,cACH,CAbD,CAeA,QAAST,SAAT,EAAoB,CAChB,GAAMU,cAAeL,SAASM,gBAAT,CAA0B,cAA1B,CAArB,CACA,GAAMC,IAAKC,WAAX,CAEA,QAASC,gBAAT,CAAyBC,GAAzB,CAA8B,CAC1BC,OAAOJ,EAAP,CAAW,CACPK,aAAcF,GADP,CAEPG,KAAc,iBAFP,CAAX,CAIH,CAED,GAAIC,gBAAiB,KAArB,CAA4B;AAE5BT,aAAaU,OAAb,CAAqB,SAACC,IAAD,CAAU,CAC3BA,KAAKC,gBAAL,CAAsB,QAAtB,CAAgCC,YAAhC,CACH,CAFD,EAIA,GAAIC,gBAAJ,CACA,QAASD,aAAT,CAAsBE,CAAtB,CAAyB,CACrBA,EAAEC,cAAF,GAEA,GAAMC,SAAW,IAAjB,CACAH,SAAWG,QAAQC,aAAR,CAAsB,qBAAtB,CAAX,CACA,GAAI,CAACC,cAAcL,SAASM,KAAvB,CAAL,CAAoC,CAChC,GAAI,CAACX,cAAL,CAAqB,CACjB,CAAC,OAAD,CAAU,QAAV,EAAoBC,OAApB,CAA4B,SAACW,GAAD,CAAS,CACjCP,SAASF,gBAAT,CAA0BS,GAA1B,CAA+B,UAAM,CACjCC,mBAAmB,CAACH,cAAcL,SAASM,KAAvB,CAApB,CACH,CAFD,CAGH,CAJD,EAKAE,mBAAmB,CAACH,cAAcL,SAASM,KAAvB,CAApB,EACAX,eAAiB,IACpB,CACD,MAAO,MACV,CAED,GAAIP,GAAGqB,UAAH,GAAkB,CAAtB,CAAyB,CACrBnB,gBAAgBU,SAASM,KAAzB,CACH,CAFD,IAEO,CACHlB,GAAGsB,MAAH,CAAYpB,eACf,CACD,MAAO,KACV,CAEDF,GAAGuB,SAAH,CAAe,SAASC,GAAT,CAAc,CACzB,GAAMC,UAAWC,KAAKC,KAAL,CAAWH,IAAII,IAAf,CAAjB,CACAR,mBAAmBR,QAAnB,CAA6Ba,SAASI,KAAtC,EACA,GAAI,CAACJ,SAASI,KAAd,CAAqB,CACjB/B,aAAaU,OAAb,CAAqB,SAACsB,EAAD,CAAQ,CACzBA,GAAGd,aAAH,CAAiB,oBAAjB,EAAuCe,SAAvC,CAAiDC,GAAjD,CAAqD,WAArD,EACAF,GAAGd,aAAH,CAAiB,sBAAjB,EAAyCe,SAAzC,CAAmDE,MAAnD,CAA0D,WAA1D,CACH,CAHD,CAIH,CACJ,CACJ,CAED,QAAShB,cAAT,CAAuBiB,KAAvB,CAA8B,CAC1B,MAAO,qDAAoDC,IAApD,CAAyDD,KAAzD,CACV,CAED,QAASd,mBAAT,CAA4BgB,SAA5B,CAAuC,CACnC3C,SAASM,gBAAT,CAA0B,qBAA1B,EAAiDS,OAAjD,CAAyD,SAACsB,EAAD,CAAQ,CAC7DA,GAAGC,SAAH,CAAaK,UAAY,KAAZ,CAAoB,QAAjC,EAA2C,aAA3C,CACH,CAFD,EAGA3C,SAASM,gBAAT,CAA0B,YAA1B,EAAwCS,OAAxC,CAAgD,SAACsB,EAAD,CAAQ,CACpDA,GAAGC,SAAH,CAAaK,UAAY,QAAZ,CAAuB,KAApC,EAA2C,WAA3C,CACH,CAFD,CAGH","file":"japan.js","sourcesContent":["/* global toggleMobileMenu:false */\nwindow.onload = function() {\n    toggleMobileMenu();\n    initForm();\n\n    window.onresize = checkWidth;\n\n    // Store gclid\n    const gclid = getParamValue(document.referrer, 'gclid');\n    if (gclid) {\n        localStorage.setItem('gclid', gclid);\n    }\n\n    commonOnload();\n};\n\nfunction initForm() {\n    const signup_forms = document.querySelectorAll('.signup-form');\n    const ws = wsConnect();\n\n    function sendVerifyEmail(val) {\n        wsSend(ws, {\n            verify_email: val,\n            type        : 'account_opening',\n        });\n    }\n\n    let validation_set = false; // To prevent validating before submit\n\n    signup_forms.forEach((form) => {\n        form.addEventListener('submit', handleSubmit);\n    });\n\n    let el_email;\n    function handleSubmit(e) {\n        e.preventDefault();\n\n        const el_form  = this;\n        el_email = el_form.querySelector('input[type=\"email\"]');\n        if (!validateEmail(el_email.value)) {\n            if (!validation_set) {\n                ['input', 'change'].forEach((evt) => {\n                    el_email.addEventListener(evt, () => {\n                        setValidationStyle(!validateEmail(el_email.value));\n                    });\n                });\n                setValidationStyle(!validateEmail(el_email.value));\n                validation_set = true;\n            }\n            return false;\n        }\n\n        if (ws.readyState === 1) {\n            sendVerifyEmail(el_email.value);\n        } else {\n            ws.onopen = sendVerifyEmail;\n        }\n        return true;\n    }\n\n    ws.onmessage = function(msg) {\n        const response = JSON.parse(msg.data);\n        setValidationStyle(el_email, response.error);\n        if (!response.error) {\n            signup_forms.forEach((el) => {\n                el.querySelector('.signup-form-input').classList.add('invisible');\n                el.querySelector('.signup-form-success').classList.remove('invisible');\n            });\n        }\n    };\n}\n\nfunction validateEmail(email) {\n    return /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,63}$/.test(email);\n}\n\nfunction setValidationStyle(has_error) {\n    document.querySelectorAll('input[type=\"email\"]').forEach((el) => {\n        el.classList[has_error ? 'add' : 'remove']('error-field');\n    });\n    document.querySelectorAll('.error-msg').forEach((el) => {\n        el.classList[has_error ? 'remove' : 'add']('invisible');\n    });\n}\n"]}