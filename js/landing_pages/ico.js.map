{"version":3,"sources":["../../../src/javascript/lib/landing_pages/ico.js"],"names":["window","onload","clients_country","getClientCountry","toggleMobileMenu","hashRouter","collapseNavbar","dataLayer","push","language","getLanguage","toUpperCase","event","switchView","path","document","getElementById","classList","hash","location","substr","test","bom_country_abbrev","clearHash","i","querySelectorAll","remove","getElementsByTagName","add","navbarHeight","checkWidth","to","offsetTop","scrollTo","el_langs","getElementsByClassName","length","value","addEventListener","e","target","contains","preventDefault","getAttribute","offset","onresize","onscroll","slider","tns","container","slideBy","rewind","controls","autoplay","autoplayHoverPause","speed","items","gutter","responsive","onInit","dispatchEvent","Event","history","pushState","pathname","sessionStorage","getItem","residence_list","accounts","JSON","parse","localStorage","Object","keys","some","loginid","residence","setSession","ws","wsConnect","sendRequests","wsSend","website_status","time","readyState","onopen","onmessage","msg","response","data","stringify","initCountdown","navbarFixedTopEl","scrollY","start_epoch","ico_start","Date","ico_end","date_diff","el_container","hidden_class","elements","remaining","countdownd_interval","is_before_start","is_started","end_date","updateStatus","calcRemainingTime","total","display_class","forEach","el","clearInterval","id","item","querySelector","arcs","arc_cover","updateCountdown","arc","days","hours","minutes","seconds","setInterval","Math","floor","scale","innerHTML","slice","angle","idx","arc_angle","min","setAttribute","join"],"mappings":"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","file":"ico.js","sourcesContent":["window.onload = function() {\n    const clients_country = getClientCountry();\n\n    toggleMobileMenu();\n    hashRouter();\n    collapseNavbar();\n\n    dataLayer.push({ language: getLanguage().toUpperCase() });\n    dataLayer.push({ event: 'page_load' });\n\n    function switchView(path) {\n        document.getElementById('faq').classList[path === 'faq' ? 'remove' : 'add']('invisible');\n        document.getElementById('home').classList[path === 'faq' ? 'add' : 'remove']('invisible');\n    }\n\n    function hashRouter() {\n        const hash = window.location.hash.substr(1);\n\n        if (/done/.test(hash)) {\n            dataLayer.push({ bom_country_abbrev: clients_country || '' });\n            dataLayer.push({ event: 'ico_success' });\n            clearHash();\n            for (let i = 0; i < 2; i++) {\n                document.querySelectorAll('.notice-msg')[i].classList.remove('invisible');\n                document.getElementsByTagName('form')[i].classList.add('invisible');\n            }\n            let navbarHeight = checkWidth();\n            const to = document.getElementById('coming-soon').offsetTop - navbarHeight;\n            scrollTo(to);\n        }\n\n        if (/faq/.test(hash)) {\n            switchView('faq');\n            scrollTo(0);\n            window.location.hash = '#faq';\n        }\n\n        if (!hash) {\n            switchView('home');\n            scrollTo(0);\n            clearHash();\n        }\n    }\n\n    // Set language fields\n    const language = getLanguage();\n    const el_langs = document.getElementsByClassName('frm-language');\n    for (let i = 0; i < el_langs.length; i++) {\n        el_langs[i].value = language;\n    }\n\n    // Scroll to section\n    document.addEventListener('click', function(e) {\n        if (e.target.classList.contains('page-scroll')) {\n            e.preventDefault();\n            switchView('home');\n            clearHash();\n            const target = e.target.getAttribute('href').substr(1);\n            const offset = /who-we-are|page-top/.test(target) ? 55 : 0;\n            const navbarHeight = checkWidth();\n            const to = document.getElementById(target).offsetTop - navbarHeight - offset;\n            scrollTo(to);\n        }\n    });\n\n    window.onresize = checkWidth;\n    window.onscroll = collapseNavbar;\n    window.addEventListener('hashchange', hashRouter);\n\n    // News slider configuration\n    const slider = tns({\n        container: '.my-slider',\n        slideBy: 'page',\n        rewind: true,\n        controls: true,\n        autoplay: true,\n        autoplayHoverPause: true,\n        speed: 600,\n        items: 2,   // start with mobile config\n        gutter: 5,\n        responsive: {\n            900: {  // desktop config\n                items: 4,\n                gutter: 20,\n            },\n            640: {  // tablet config\n                items: 3,\n                gutter: 15,\n            },\n        },\n        onInit: function() {\n            window.dispatchEvent(new Event('resize')); // trigger resize event\n            document.getElementsByClassName('slider-container')[0].classList.remove('invisible');\n        }\n    });\n};\n\nfunction clearHash() {\n    if (window.history.pushState) {\n        window.history.pushState('', '/', window.location.pathname);\n    } else {\n        window.location.hash = '';\n    }\n}\n\nfunction getClientCountry() {\n    let clients_country = sessionStorage.getItem('clients_country');\n    let residence_list  = sessionStorage.getItem('residence_list');\n\n    // Try to get residence from client's info if logged-in\n    if (!clients_country) {\n        const accounts = JSON.parse(localStorage.getItem('client.accounts') || null);\n        if (accounts) {\n            Object.keys(accounts).some(function (loginid) {\n                if (accounts[loginid].residence) {\n                    clients_country = accounts[loginid].residence;\n                    setSession('clients_country', clients_country);\n                    return true;\n                }\n            });\n        }\n    }\n\n    // Get required info from WebSocket\n    const ws = wsConnect();\n\n    function sendRequests() {\n        if (!clients_country) wsSend(ws, { website_status: 1 });\n        if (!residence_list)  wsSend(ws, { residence_list: 1 });\n        wsSend(ws, { time: 1 });\n    }\n\n    if (ws.readyState === 1) {\n        sendRequests();\n    } else {\n        ws.onopen = sendRequests;\n    }\n\n    ws.onmessage = function (msg) {\n        const response = JSON.parse(msg.data);\n        if (response.website_status) {\n            clients_country = response.website_status.clients_country;\n            setSession('clients_country', clients_country);\n        } else if (response.residence_list) {\n            setSession('residence_list', JSON.stringify(response.residence_list));\n        } else if (response.time) {\n            initCountdown(response.time);\n        }\n    }\n\n    return clients_country;\n}\n\n// Collapse navbar on scroll\nfunction collapseNavbar() {\n    const navbarFixedTopEl = document.getElementsByClassName('navbar-fixed-top');\n    navbarFixedTopEl[0].classList[window.scrollY < 50 ? 'add' : 'remove']('top-nav-collapse');\n}\n\nfunction initCountdown(start_epoch) {\n    const ico_start    = Date.parse(new Date('2017-11-15T00:00:00Z'));\n    const ico_end      = Date.parse(new Date('2017-12-25T00:00:00Z'));\n    const date_diff    = Date.parse(new Date()) - start_epoch * 1000;\n\n    const el_container = document.getElementById('status_container');\n    const hidden_class = 'invisible';\n    const elements     = {};\n    let remaining      = 0;\n    let countdownd_interval,\n        is_before_start,\n        is_started,\n        end_date;\n\n    function updateStatus() {\n        is_before_start = calcRemainingTime(ico_start, date_diff).total > 0;\n        is_started      = calcRemainingTime(ico_end,   date_diff).total > 0 && !is_before_start;\n        end_date        = is_before_start ? ico_start : ico_end;\n\n        const display_class = 'status-' + (is_before_start ? 'before-start' : is_started ? 'started' : 'ended');\n        el_container.querySelectorAll('.status-toggle').forEach(function(el) {\n            el.classList[el.classList.contains(display_class) ? 'remove' : 'add'](hidden_class);\n        });\n\n        document.getElementById('status_loading').classList.add(hidden_class);\n        el_container.classList.remove(hidden_class);\n\n        if (!is_before_start) {\n            document.getElementById('ico_subscribe_section').classList.add(hidden_class);\n            if (!is_started) { // is_ended\n                clearInterval(countdownd_interval);\n            }\n        }\n    }\n\n    updateStatus();\n\n    if (!is_before_start && !is_started) return; // no countdown when already ended\n\n    // Get all elements only once\n    ['days', 'hours', 'minutes', 'seconds'].forEach(function (id) {\n        const item = el_container.querySelector('#cd_' + id);\n        elements[id] = {\n            value    : item.querySelector('.cd-value'),\n            arcs     : item.querySelectorAll('.arc_q'),\n            arc_cover: item.querySelector('.arc_cover'),\n        };\n    });\n\n    function updateCountdown() {\n        remaining = calcRemainingTime(end_date, date_diff);\n\n        arc(elements.days,    remaining.days,    is_before_start ? 20 : 40);\n        arc(elements.hours,   remaining.hours,   24);\n        arc(elements.minutes, remaining.minutes, 60);\n        arc(elements.seconds, remaining.seconds, 60);\n\n        if (remaining.total <= 0) {\n            updateStatus();\n        }\n    }\n\n    updateCountdown();\n\n    if (remaining.total > 0) {\n        countdownd_interval = setInterval(updateCountdown, 1000);\n    }\n}\n\nfunction calcRemainingTime(end_date, date_diff) {\n    const total   = Math.floor(end_date - Date.parse(new Date()) + date_diff) / 1000;\n    const seconds = Math.floor(total % 60);\n    const minutes = Math.floor((total / 60) % 60);\n    const hours   = Math.floor((total / (60 * 60)) % 24);\n    const days    = Math.floor(total / (60 * 60 * 24));\n\n    return {\n        total  : total,\n        days   : days,\n        hours  : hours,\n        minutes: minutes,\n        seconds: seconds,\n    };\n}\n\nfunction arc(el, value, scale) {\n    el.value.innerHTML = ('0' + value).slice(-2);\n\n    const angle = value * 360 / scale;\n    el.arcs.forEach(function(arc, idx) {\n        const arc_angle = Math.min((idx + 1) * 90, angle) - 135;\n        arc.setAttribute('style', ['-webkit-', '-moz-', '-o-', '-ms-', '', ''].join('transform: rotate(' + arc_angle + 'deg); '));\n    });\n    el.arc_cover.classList[angle > 90 ? 'add' : 'remove']('invisible');\n}\n"]}