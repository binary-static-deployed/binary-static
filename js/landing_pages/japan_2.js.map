{"version":3,"sources":["../../../src/javascript/landing_pages/japan_2.js"],"names":["window","onload","toggleMobileMenu","initForm","collapseNavbar","tabWithButtons","onresize","checkWidth","document","querySelectorAll","forEach","el","addEventListener","e","preventDefault","scrollToSection","gclid","getParamValue","referrer","localStorage","setItem","navbarFixedTopEl","getElementsByClassName","classList","scrollY","onscroll","target_el","target_href","getAttribute","substr","to","getElementById","offsetTop","scrollTo","collapseMenu","signup_forms","ws","wsConnect","sendVerifyEmail","val","trimmed_email","trimEmail","wsSend","verify_email","type","verifySubmit","msg","response","JSON","parse","data","setValidationStyle","el_email","error","querySelector","add","remove","str","replace","validation_set","form","handleSubmit","el_form","validateEmail","value","evt","readyState","onopen","onmessage","email","test","has_error","id","el_tab_container","body","el_content_container","el_content_wrapper","el_contents","num_of_items","length","current_index","navs","touchstartX","touchstartY","touchendX","touchendY","parent","ul","createElement","idx","li","createLIElement","appendChild","btn_prev","setAttribute","updateTabContent","btn_next","event","changedTouches","screenX","screenY","touchEventsHandler","diffY","nochangeY","index","target_index","direction","width","getBoundingClientRect","mod","active_index","updateActiveContent","updateActiveNav","offset","style","left","i"],"mappings":"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","file":"japan_2.js","sourcesContent":["window.onload = function () {\n    toggleMobileMenu();\n    initForm();\n    collapseNavbar();\n    tabWithButtons();\n\n    window.onresize = checkWidth;\n\n    document.querySelectorAll('.page-scroll').forEach((el) => {\n        el.addEventListener('click', function(e) {\n            e.preventDefault();\n            scrollToSection(this);\n        });\n    });\n\n    // Store gclid\n    const gclid = getParamValue(document.referrer, 'gclid');\n    if (gclid) {\n        localStorage.setItem('gclid', gclid);\n    }\n\n    // Collapse navbar on scroll\n    function collapseNavbar() {\n        const navbarFixedTopEl = document.getElementsByClassName('navbar-fixed-top');\n        navbarFixedTopEl[0].classList[window.scrollY < 50 ? 'add' : 'remove']('top-nav-collapse');\n    }\n\n    window.onscroll = collapseNavbar;\n};\n\nfunction scrollToSection(target_el) {\n    const target_href = target_el.getAttribute('href').substr(1);\n    const to = document.getElementById(target_href).offsetTop - 70;\n    scrollTo(to, 500);\n    collapseMenu();\n}\n\nfunction initForm() {\n    const signup_forms = document.querySelectorAll('.signup-form');\n    let ws = wsConnect();\n\n    function sendVerifyEmail(val) {\n        const trimmed_email = trimEmail(val);\n        wsSend(ws, {\n            verify_email: trimmed_email,\n            type        : 'account_opening',\n        });\n    }\n\n    function verifySubmit(msg) {\n        const response = JSON.parse(msg.data);\n        setValidationStyle(el_email, response.error);\n        if (!response.error) {\n            signup_forms.forEach((el) => {\n                el.querySelector('.signup-form-input').classList.add('invisible');\n                el.querySelector('.signup-form-success').classList.remove('invisible');\n            });\n        }\n    }\n\n    function trimEmail(str) {\n        return str.replace(/\\s/g, '');\n    }\n\n    let validation_set = false; // To prevent validating before submit\n\n    signup_forms.forEach((form) => {\n        form.addEventListener('submit', handleSubmit);\n    });\n\n    let el_email;\n    function handleSubmit(e) {\n        e.preventDefault();\n\n        const el_form  = this;\n        el_email = el_form.querySelector('input[type=\"email\"]');\n        if (!validateEmail(el_email.value)) {\n            if (!validation_set) {\n                ['input', 'change'].forEach((evt) => {\n                    el_email.addEventListener(evt, () => {\n                        setValidationStyle(!validateEmail(el_email.value));\n                    });\n                });\n                setValidationStyle(!validateEmail(el_email.value));\n                validation_set = true;\n            }\n            const to = this.offsetTop - 50;\n            scrollTo(to, 500); // Scroll to nearest form\n            return false;\n        }\n\n        if (ws.readyState === 1) {\n            sendVerifyEmail(el_email.value);\n        } else {\n            ws = wsConnect();\n            ws.onopen = sendVerifyEmail(el_email.value);\n            ws.onmessage = verifySubmit;\n        }\n        return true;\n    }\n\n    ws.onmessage = verifySubmit;\n}\n\nfunction validateEmail(email) {\n    return /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,63}$/.test(email);\n}\n\nfunction setValidationStyle(has_error) {\n    document.querySelectorAll('input[type=\"email\"]').forEach((el) => {\n        el.classList[has_error ? 'add' : 'remove']('error-field');\n    });\n    document.querySelectorAll('.error-msg').forEach((el) => {\n        el.classList[has_error ? 'remove' : 'add']('invisible');\n    });\n}\n\nfunction tabWithButtons(id) {\n    const el_tab_container     = document.getElementById(id) ? document.getElementById(id) : document.body;\n    const el_content_container = el_tab_container.getElementsByClassName('twb-content-container')[0];\n    const el_content_wrapper   = el_tab_container.getElementsByClassName('twb-content-wrapper')[0];\n    const el_contents          = el_tab_container.querySelectorAll('div.twb-content');\n    const num_of_items = el_contents.length;\n    let current_index  = 0;\n    let navs;\n    let touchstartX = 0;\n    let touchstartY = 0;\n    let touchendX = 0;\n    let touchendY = 0;\n\n    (() => {\n        const parent = el_tab_container.querySelector('.twb-buttons');\n        const ul = document.createElement('ul');\n        for (let idx = 0; idx < num_of_items; idx++) {\n            const li = createLIElement(idx);\n            ul.appendChild(li);\n        }\n\n        const btn_prev = document.createElement('a');\n        btn_prev.classList.add('twb-button', 'twb-button-prev');\n        btn_prev.setAttribute('href', 'javascript:;');\n        btn_prev.addEventListener('click', (e) => {\n            e.preventDefault();\n            updateTabContent(--current_index);\n        });\n\n        const btn_next = document.createElement('a');\n        btn_next.classList.add('twb-button', 'twb-button-next');\n        btn_next.setAttribute('href', 'javascript:;');\n        btn_next.addEventListener('click', (e) => {\n            e.preventDefault();\n            updateTabContent(++current_index);\n        });\n\n        parent.appendChild(btn_prev);\n        parent.appendChild(ul);\n        parent.appendChild(btn_next);\n\n        navs = ul.querySelectorAll('li');\n\n        window.onresize = function() {\n            updateTabContent(current_index);\n        };\n\n        el_content_wrapper.addEventListener('touchstart', (event) => {\n            touchstartX = event.changedTouches[0].screenX;\n            touchstartY = event.changedTouches[0].screenY;\n        }, false);\n        el_content_wrapper.addEventListener('touchend', (event) => {\n            touchendX = event.changedTouches[0].screenX;\n            touchendY = event.changedTouches[0].screenY;\n            touchEventsHandler();\n        }, false);\n\n        function touchEventsHandler() {\n            const diffY = touchendY - touchstartY;\n            const nochangeY = diffY >= -15 && diffY <= 15 ;\n            if (touchendX <= touchstartX && nochangeY) {\n                updateTabContent(++current_index); // swipe left\n            }\n            if (touchendX >= touchstartX && nochangeY) {\n                updateTabContent(--current_index); // swipe right\n            }\n        }\n\n        function createLIElement(index) {\n            const li = document.createElement('li');\n            li.classList[index ? 'remove' : 'add']('active');\n            li.addEventListener('click', (e) => {\n                e.preventDefault();\n                updateTabContent(index, false);\n                current_index = index;\n            });\n            return li;\n        }\n    })();\n\n    function updateTabContent(target_index, direction = true) {\n        const width = el_content_container.getBoundingClientRect().width;\n        const mod   = target_index % num_of_items;\n        let active_index;\n\n        if (direction) {\n            active_index = mod;\n            if (mod < 0) {\n                active_index = mod + num_of_items;\n            }\n        } else {\n            active_index = target_index;\n        }\n\n        updateActiveContent(active_index);\n        updateActiveNav(active_index);\n\n        function updateActiveContent(idx) {\n            const offset = idx * width;\n            el_content_container.style.left = `${((offset > 0 ? -offset : offset) % (num_of_items * width))}px`;\n        }\n        function updateActiveNav(idx) {\n            navs.forEach((el, i) => {\n                el.classList[idx === i ? 'add' : 'remove']('active');\n            });\n        }\n    }\n}\n"]}