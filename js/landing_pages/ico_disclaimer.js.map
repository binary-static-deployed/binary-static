{"version":3,"sources":["../../../src/javascript/lib/landing_pages/ico_disclaimer.js"],"names":["el_residence_list","window","onload","frm_select_residence","document","getElementById","frm_accept_disclaimer","frm_accept_second_notice","getResidenceList","isRestrictedCountry","val","regex","RegExp","join","test","country_names","code","name","showSecondNotice","country_name","map","item","idx","appendChild","createTextNode","classList","remove","showDisclaimer","hideForm","parentNode","add","addEventListener","e","preventDefault","checked","url","open","validation_set","value","validateResidence","evt","el","el_error","getElementsByClassName","residence_list","JSON","parse","sessionStorage","getItem","populateResidenceList","sendResidenceList","wsSend","ws","wsConnect","readyState","onopen","onmessage","msg","response","data","setSession","stringify","forEach","res","el_option","createElement","text"],"mappings":"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","file":"ico_disclaimer.js","sourcesContent":["var el_residence_list;\nwindow.onload = function() {\n    var frm_select_residence     = document.getElementById('frm_select_residence');\n    var frm_accept_disclaimer    = document.getElementById('frm_accept_disclaimer');\n    var frm_accept_second_notice = document.getElementById('frm_accept_second_notice');\n    el_residence_list            = document.getElementById('residence_list');\n\n    // Get and then Populate residence list\n    getResidenceList();\n\n    function isRestrictedCountry(val) {\n        // restricted countries code\n        var regex = new RegExp(['^(',\n            'as|af|at|au|be|bg|ca|ch|cy|cz|de|dk|ee|es|fi|fr|gg|gb|gr|gu|hk|hr|hu|ie|il|im|it|',\n            'iq|ir|je|jp|kp|lt|lu|lv|mp|mt|my|nl|nz|pl|pt|pr|ro|se|sg|si|sk|sy|sz|us|vi|vg|vu',\n            ')$'].join(''));\n        if (regex.test(val)) {\n            return true;\n        }\n        return false;\n    }\n\n    var country_names = [\n        { code: 'ca', name: 'Canada' },\n        { code: 'gb', name: 'the United Kingdom' },\n        { code: 'eu', name: 'the European Economic Area' },\n        { code: 'hk', name: 'Hong Kong' },\n        { code: 'jp', name: 'Japan' },\n        { code: 'sg', name: 'Singapore' },\n        { code: 'ch', name: 'Switzerland' },\n    ]\n\n    function showSecondNotice(val) {\n        var country_name;\n        country_names.map(function(item, idx) {\n            if (item.code === val) {\n                country_name = item.name;\n            }\n        });\n        document.getElementById('country_name').appendChild(document.createTextNode(country_name));\n        document.getElementById('notice_msg').classList.remove('invisible');\n        document.getElementById(val).classList.remove('invisible');\n    }\n\n    function showDisclaimer(val) {\n        if (isRestrictedCountry(val)) {\n            // eu countries code\n            if (/^(al|ad|at|by|be|ba|bg|hr|cy|cz|dk|ee|fo|fi|fr|de|gi|gr|hu|is|ie|im|it|ru|lv|li|lt|lu|mk|mt|md|mc|me|nl|no|pl|pt|ro|sm|sk|si|es|se|ch|ua|va)$/.test(val)) {\n                val = 'eu';\n            }\n\n            if (/^(ca|jp|sg|hk|gb|ch|eu)$/.test(val)) {\n                showSecondNotice(val);\n            } else {\n                document.getElementById('access_denied_msg').classList.remove('invisible');\n            }\n        } else {\n            document.getElementById('disclaimer_msg').classList.remove('invisible');\n        }\n    }\n\n    function hideForm() {\n        frm_select_residence.parentNode.classList.add('invisible');\n    }\n\n    frm_accept_disclaimer.addEventListener('submit', function (e) {\n        e.preventDefault();\n        var val = document.getElementById('checkbox').checked; // true or false\n        var url = 'https://ico_documents.binary.com/im.pdf';\n        if (val) {\n            window.open(url, '_self');\n        } else {\n            document.getElementById('frm_accept_disclaimer_error').classList.remove('invisible');\n        }\n    });\n\n    var validation_set = false; // To prevent validating before submit\n\n    frm_select_residence.addEventListener('submit', function (e) {\n        e.preventDefault();\n        var val = document.getElementById('residence_list').value;\n        if (!validateResidence(this)) {\n            if (!validation_set) {\n                this.addEventListener('change', function (evt) {\n                    evt.preventDefault();\n                    validateResidence(this);\n                    validation_set = true;\n                })\n            }\n            return false;\n        }\n        hideForm();\n        showDisclaimer(val);\n    });\n\n    frm_accept_second_notice.addEventListener('submit', function(e) {\n        e.preventDefault();\n        var val = document.getElementById('checkbox-2').checked; // true or false\n        var url = 'https://ico_documents.binary.com/im.pdf';\n        if (val) {\n            document.getElementById('notice_msg').classList.add('invisible');\n            showDisclaimer(val);\n        } else {\n            document.getElementById('frm_accept_notice_error').classList.remove('invisible');\n        }\n    })\n};\n\nfunction validateResidence(el) {\n    var val      = document.getElementById('residence_list').value;\n    var el_error = el.getElementsByClassName('error-msg')[0];\n    if (val === '0') {\n        el_error.classList.remove('invisible');\n        return false;\n    }\n    el_error.classList.add('invisible');\n    return true;\n}\n\nfunction getResidenceList() {\n    var residence_list = JSON.parse(sessionStorage.getItem('residence_list') || null);\n    if (residence_list) {\n        populateResidenceList(residence_list);\n    } else {\n        var ws = wsConnect();\n        function sendResidenceList() {\n            wsSend(ws, { residence_list: 1 });\n        }\n\n        if (ws.readyState === 1) {\n            sendResidenceList();\n        } else {\n            ws.onopen = sendResidenceList;\n        }\n\n        ws.onmessage = function(msg) {\n            var response = JSON.parse(msg.data);\n            if (response.residence_list) {\n                populateResidenceList(response.residence_list);\n                setSession('residence_list', JSON.stringify(response.residence_list));\n            }\n        }\n    }\n}\n\nfunction populateResidenceList(residence_list) {\n    residence_list.forEach(function(res) {\n        var el_option = document.createElement('option');\n        el_option.text  = res.text;\n        el_option.value = res.value;\n        el_residence_list.appendChild(el_option);\n    });\n    document.getElementById('loading').classList.add('invisible');\n    document.getElementById('disclaimer_form').classList.remove('invisible');\n}\n"]}