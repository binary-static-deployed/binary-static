{"version":3,"sources":["../../../src/javascript/landing_pages/signup_frame.js"],"names":["error_class","window","onload","dataLayer","push","event","el_email","document","getElementById","el_signup","el_success","ws","wsConnect","sendVerifyEmail","wsSend","verify_email","value","type","validation_set","addEventListener","evt","preventDefault","validateEmail","forEach","setValidationStyle","readyState","onopen","onmessage","msg","response","JSON","parse","data","error","classList","add","remove","gclid","getParamValue","referrer","localStorage","setItem","email","test","element","has_error"],"mappings":"AAAA,GAAIA,aAAc,aAAlB,CAEAC,OAAOC,MAAP,CAAgB,UAAY,CACxBC,UAAUC,IAAV,CAAe,CAAEC,MAAO,WAAT,CAAf,EAEA,GAAIC,UAAaC,SAASC,cAAT,CAAwB,OAAxB,CAAjB,CACA,GAAIC,WAAaF,SAASC,cAAT,CAAwB,QAAxB,CAAjB,CACA,GAAIE,YAAaH,SAASC,cAAT,CAAwB,SAAxB,CAAjB,CAEA,GAAIG,IAAKC,WAAT,CAEA,QAASC,gBAAT,EAA2B,CACvBC,OAAOH,EAAP,CAAW,CACPI,aAAcT,SAASU,KADhB,CAEPC,KAAc,iBAFP,CAAX,CAIH,CAED,GAAIC,gBAAiB,KAArB,CAA4B;AAE5BX,SAASC,cAAT,CAAwB,kBAAxB,EAA4CW,gBAA5C,CAA6D,QAA7D,CAAuE,SAAUC,GAAV,CAAe,CAClFA,IAAIC,cAAJ,GAEA,GAAI,CAACC,cAAchB,SAASU,KAAvB,CAAL,CAAoC,CAChC,GAAI,CAACE,cAAL,CAAqB,CACjB,CAAC,OAAD,CAAU,QAAV,EAAoBK,OAApB,CAA4B,SAAUH,GAAV,CAAe,CACvCd,SAASa,gBAAT,CAA0BC,GAA1B,CAA+B,UAAY,CACvCI,mBAAmBlB,QAAnB,CAA6B,CAACgB,cAAchB,SAASU,KAAvB,CAA9B,CACH,CAFD,CAGH,CAJD,EAKAQ,mBAAmBlB,QAAnB,CAA6B,CAACgB,cAAchB,SAASU,KAAvB,CAA9B,EACAE,eAAiB,IACpB,CACD,MAAO,MACV,CAED,GAAIP,GAAGc,UAAH,GAAkB,CAAtB,CAAyB,CACrBZ,iBACH,CAFD,IAEO,CACHF,GAAGe,MAAH,CAAYb,eACf,CACJ,CArBD,EAuBAF,GAAGgB,SAAH,CAAe,SAASC,GAAT,CAAc,CACzB,GAAIC,UAAWC,KAAKC,KAAL,CAAWH,IAAII,IAAf,CAAf,CACAR,mBAAmBlB,QAAnB,CAA6BuB,SAASI,KAAtC,EACA,GAAI,CAACJ,SAASI,KAAd,CAAqB,CACjBxB,UAAUyB,SAAV,CAAoBC,GAApB,CAAwB,WAAxB,EACAzB,WAAWwB,SAAX,CAAqBE,MAArB,CAA4B,WAA5B,CACH,CACJ,CAPD,CASA;AACA,GAAIC,OAAQC,cAAc/B,SAASgC,QAAvB,CAAiC,OAAjC,CAAZ,CACA,GAAIF,KAAJ,CAAW,CACPG,aAAaC,OAAb,CAAqB,OAArB,CAA8BJ,KAA9B,CACH,CACJ,CAvDD,CAyDA,QAASf,cAAT,CAAuBoB,KAAvB,CAA8B,CAC1B,MAAO,qDAAoDC,IAApD,CAAyDD,KAAzD,CACV,CAED,QAASlB,mBAAT,CAA4BoB,OAA5B,CAAqCC,SAArC,CAAgD,CAC5CD,QAAQV,SAAR,CAAkBW,UAAY,KAAZ,CAAoB,QAAtC,EAAgD7C,WAAhD,CACH","file":"signup_frame.js","sourcesContent":["var error_class = 'error-field';\n\nwindow.onload = function () {\n    dataLayer.push({ event: 'page_load' });\n\n    var el_email   = document.getElementById('email');\n    var el_signup  = document.getElementById('signup');\n    var el_success = document.getElementById('success');\n\n    var ws = wsConnect();\n\n    function sendVerifyEmail() {\n        wsSend(ws, {\n            verify_email: el_email.value,\n            type        : 'account_opening'\n        });\n    }\n\n    var validation_set = false; // To prevent validating before submit\n\n    document.getElementById('frm_verify_email').addEventListener('submit', function (evt) {\n        evt.preventDefault();\n\n        if (!validateEmail(el_email.value)) {\n            if (!validation_set) {\n                ['input', 'change'].forEach(function (evt) {\n                    el_email.addEventListener(evt, function () {\n                        setValidationStyle(el_email, !validateEmail(el_email.value));\n                    });\n                });\n                setValidationStyle(el_email, !validateEmail(el_email.value));\n                validation_set = true;\n            }\n            return false;\n        }\n\n        if (ws.readyState === 1) {\n            sendVerifyEmail();\n        } else {\n            ws.onopen = sendVerifyEmail;\n        }\n    });\n\n    ws.onmessage = function(msg) {\n        var response = JSON.parse(msg.data);\n        setValidationStyle(el_email, response.error);\n        if (!response.error) {\n            el_signup.classList.add('invisible');\n            el_success.classList.remove('invisible');\n        }\n    };\n\n    // Store gclid\n    var gclid = getParamValue(document.referrer, 'gclid');\n    if (gclid) {\n        localStorage.setItem('gclid', gclid);\n    }\n};\n\nfunction validateEmail(email) {\n    return /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,63}$/.test(email);\n}\n\nfunction setValidationStyle(element, has_error) {\n    element.classList[has_error ? 'add' : 'remove'](error_class);\n}\n"]}